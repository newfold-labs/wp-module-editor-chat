(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{ChatEditor:()=>It});var n={};e.r(n),e.d(n,{closeModal:()=>T,disableComplementaryArea:()=>_,enableComplementaryArea:()=>y,openModal:()=>v,pinItem:()=>w,setDefaultComplementaryArea:()=>g,setFeatureDefaults:()=>E,setFeatureValue:()=>k,toggleFeature:()=>A,unpinItem:()=>b});var r={};e.r(r),e.d(r,{getActiveComplementaryArea:()=>S,isComplementaryAreaLoading:()=>N,isFeatureActive:()=>C,isItemPinned:()=>x,isModalActive:()=>I});const o=window.wp.domReady;var a=e.n(o);const i=window.wp.plugins,s=window.wp.data,c=window.wp.editor,l=window.wp.element,d=window.wp.i18n,u=window.wp.deprecated;var p=e.n(u);const m=window.wp.preferences;function h(e){return["core/edit-post","core/edit-site"].includes(e)?(p()(`${e} interface scope`,{alternative:"core interface scope",hint:"core/edit-post and core/edit-site are merging.",version:"6.6"}),"core"):e}function f(e,t){return"core"===e&&"edit-site/template"===t?(p()("edit-site/template sidebar",{alternative:"edit-post/document",version:"6.6"}),"edit-post/document"):"core"===e&&"edit-site/block-inspector"===t?(p()("edit-site/block-inspector sidebar",{alternative:"edit-post/block",version:"6.6"}),"edit-post/block"):t}const g=(e,t)=>({type:"SET_DEFAULT_COMPLEMENTARY_AREA",scope:e=h(e),area:t=f(e,t)}),y=(e,t)=>({registry:n,dispatch:r})=>{t&&(e=h(e),t=f(e,t),n.select(m.store).get(e,"isComplementaryAreaVisible")||n.dispatch(m.store).set(e,"isComplementaryAreaVisible",!0),r({type:"ENABLE_COMPLEMENTARY_AREA",scope:e,area:t}))},_=e=>({registry:t})=>{e=h(e),t.select(m.store).get(e,"isComplementaryAreaVisible")&&t.dispatch(m.store).set(e,"isComplementaryAreaVisible",!1)},w=(e,t)=>({registry:n})=>{if(!t)return;e=h(e),t=f(e,t);const r=n.select(m.store).get(e,"pinnedItems");!0!==r?.[t]&&n.dispatch(m.store).set(e,"pinnedItems",{...r,[t]:!0})},b=(e,t)=>({registry:n})=>{if(!t)return;e=h(e),t=f(e,t);const r=n.select(m.store).get(e,"pinnedItems");n.dispatch(m.store).set(e,"pinnedItems",{...r,[t]:!1})};function A(e,t){return function({registry:n}){p()("dispatch( 'core/interface' ).toggleFeature",{since:"6.0",alternative:"dispatch( 'core/preferences' ).toggle"}),n.dispatch(m.store).toggle(e,t)}}function k(e,t,n){return function({registry:r}){p()("dispatch( 'core/interface' ).setFeatureValue",{since:"6.0",alternative:"dispatch( 'core/preferences' ).set"}),r.dispatch(m.store).set(e,t,!!n)}}function E(e,t){return function({registry:n}){p()("dispatch( 'core/interface' ).setFeatureDefaults",{since:"6.0",alternative:"dispatch( 'core/preferences' ).setDefaults"}),n.dispatch(m.store).setDefaults(e,t)}}function v(e){return{type:"OPEN_MODAL",name:e}}function T(){return{type:"CLOSE_MODAL"}}const S=(0,s.createRegistrySelector)(e=>(t,n)=>{n=h(n);const r=e(m.store).get(n,"isComplementaryAreaVisible");if(void 0!==r)return!1===r?null:t?.complementaryAreas?.[n]}),N=(0,s.createRegistrySelector)(e=>(t,n)=>{n=h(n);const r=e(m.store).get(n,"isComplementaryAreaVisible"),o=t?.complementaryAreas?.[n];return r&&void 0===o}),x=(0,s.createRegistrySelector)(e=>(t,n,r)=>{var o;r=f(n=h(n),r);const a=e(m.store).get(n,"pinnedItems");return null===(o=a?.[r])||void 0===o||o}),C=(0,s.createRegistrySelector)(e=>(t,n,r)=>(p()("select( 'core/interface' ).isFeatureActive( scope, featureName )",{since:"6.0",alternative:"select( 'core/preferences' ).get( scope, featureName )"}),!!e(m.store).get(n,r)));function I(e,t){return e.activeModal===t}const R=(0,s.combineReducers)({complementaryAreas:function(e={},t){switch(t.type){case"SET_DEFAULT_COMPLEMENTARY_AREA":{const{scope:n,area:r}=t;return e[n]?e:{...e,[n]:r}}case"ENABLE_COMPLEMENTARY_AREA":{const{scope:n,area:r}=t;return{...e,[n]:r}}}return e},activeModal:function(e=null,t){switch(t.type){case"OPEN_MODAL":return t.name;case"CLOSE_MODAL":return null}return e}}),D=(0,s.createReduxStore)("core/interface",{reducer:R,actions:n,selectors:r});(0,s.register)(D);const M=window.wp.apiFetch;var O=e.n(M);const L=window.wp.blocks,B=async()=>{const e=P(),t=j();return{page_content:e,...await U(t)}},P=()=>{const e=(0,s.select)("core/block-editor"),t=e.getBlocks(),n=t.find(e=>"core/post-content"===e.name);return n?e.getBlocks(n.clientId).map(e=>({clientId:e.clientId,content:(0,L.serialize)(e)})):t.map(e=>({clientId:e.clientId,content:(0,L.serialize)(e)}))},j=()=>(0,s.select)("core/block-editor").getBlocks().filter(e=>"core/template-part"===e.name),z=async(e,t)=>{if(!e||!e.attributes)return"";const{ref:n,slug:r,theme:o}=e.attributes;if(n){const e=await t.getEntityRecord("postType","wp_template_part",n);return e&&e.content&&(e.content.raw||e.content.rendered)||""}if(r&&o){const e=`${o}//${r}`,n=await t.getEntityRecord("postType","wp_template_part",e);if(n&&n.content)return n.content.raw||n.content.rendered||""}if(r){const e=o?{slug:[r],theme:o}:{slug:[r]},n=await t.getEntityRecords("postType","wp_template_part",e);if(Array.isArray(n)&&n.length>0){const e=n.find(e=>e&&e.slug===r&&(!o||e.theme===o))||n[0];return e&&e.content&&(e.content.raw||e.content.rendered)||""}}return""},F=(e,t)=>e.slug||(e.ref?String(e.ref):null)||e.area||`template_part_${t}`,U=async e=>{const t=(0,s.resolveSelect)("core"),n={};for(let r=0;r<e.length;r++){const o=e[r],a=o.attributes||{},i=await z(o,t),s=F(a,r);s&&!n[s]&&(n[s]={clientId:o.clientId,content:i})}return n},H=()=>{const e=(0,s.select)("core/block-editor").getSelectedBlock();return e?{...e,originalContent:(0,L.serialize)(e)}:null},$=e=>e&&"core/template-part"===e.name,G=async e=>{if(!e||!e.attributes)return null;const{ref:t,slug:n,theme:r}=e.attributes,o=(0,s.resolveSelect)("core");if(t)return await o.getEntityRecord("postType","wp_template_part",t);if(n&&r){const e=`${r}//${n}`,t=await o.getEntityRecord("postType","wp_template_part",e);if(t)return t}if(n){const e=r?{slug:[n],theme:r}:{slug:[n]},t=await o.getEntityRecords("postType","wp_template_part",e);if(Array.isArray(t)&&t.length>0)return t.find(e=>e&&e.slug===n&&(!r||e.theme===r))||t[0]}return null},W=async(e,t)=>{try{const n=await(async e=>{if(e?.attributes?.ref)return e.attributes.ref;const t=await G(e);return t?.id||null})(e);if(!n)throw new Error("Could not resolve template part entity ID");const r=t.map(e=>(0,L.serialize)(e)).join(""),o=(0,s.dispatch)("core");return await o.editEntityRecord("postType","wp_template_part",n,{content:r}),{success:!0,message:"Template part updated successfully",entityId:n,savedRecord:await o.saveEditedEntityRecord("postType","wp_template_part",n)}}catch(e){return console.error("Error updating template part:",e),{success:!1,message:`Failed to update template part: ${e.message}`,error:e}}},q=new class{async executeActions(e){if(!e||!Array.isArray(e))return{success:!0,message:"No actions to execute"};const t=[],n=[];for(const r of e)try{if(!r.action){n.push("Action missing 'action' property");continue}const e=await this.executeAction(r);t.push(e)}catch(e){n.push(e.message),console.error("Action failed:",e)}return{success:0===n.length,message:0===n.length?"All actions executed successfully":"Some actions failed",results:t,errors:n}}async executeAction(e){if("edit_content"===e.action)return this.handleEditContentAction(e);throw new Error(`Unsupported action type: ${e.action}`)}async handleEditContentAction(e){const{data:t}=e;if(!t||!t.content||!Array.isArray(t.content))throw new Error("Edit content action requires data.content array");const n=[],r=[];for(const e of t.content){const t=e.client_id,o=e.action,{changes:a}=e;if(o)try{let e;if("edit"===o){if(!t){r.push("Edit action requires client_id");continue}if(!a||!Array.isArray(a)){r.push(`Edit action for ${t} missing changes array`);continue}e=await this.handleEditAction(t,a)}else if("delete"===o){if(!t){r.push("Delete action requires client_id");continue}if("remove_block"!==a){r.push(`Delete action for ${t} must have changes: "remove_block"`);continue}e=await this.handleDeleteAction(t)}else{if("add"!==o){r.push(`Unsupported content action: ${o}`);continue}if(!a||!Array.isArray(a)){r.push("Add action missing changes array");continue}e=await this.handleAddAction(t,a)}n.push(e)}catch(e){r.push(`Failed to execute ${o} action: ${e.message}`),console.error(`Failed to execute ${o} action:`,e)}else r.push("Content item missing 'action' property")}return{type:"edit_content",success:0===r.length,message:0===r.length?"All content changes applied successfully":"Some content changes failed",results:n,errors:r}}async handleEditAction(e,t){return this.applyContentChanges(e,t)}async applyContentChanges(e,t){const{getBlock:n}=(0,s.select)("core/block-editor"),r=n(e);if(!r)throw new Error(`Block with clientId ${e} not found`);if($(r))return this.applyTemplatePartChanges(e,r,t);const o={clientId:e,name:r.name,attributes:{...r.attributes},innerBlocks:r.innerBlocks?[...r.innerBlocks]:[]};let a=(0,L.serialize)(r);for(const n of t){const{find:t,replace:r}=n;if("string"!=typeof t||"string"!=typeof r)throw new Error("Change must have find and replace as strings");const o=this.normalizeHtml(a),i=this.normalizeHtml(t),s=this.normalizeHtml(r);o.includes(i)?a=o.replace(i,s):console.warn(`Find string not found in block ${e}:`,t.substring(0,50))}const i=(0,L.parse)(a);if(!i||0===i.length)throw new Error("Failed to parse updated content into blocks");const c=i[0];if(!c)throw new Error("Failed to parse updated block");const{updateBlockAttributes:l,replaceInnerBlocks:d}=(0,s.dispatch)("core/block-editor");return c.attributes&&l(e,c.attributes),c.innerBlocks&&c.innerBlocks.length>0?d(e,c.innerBlocks.map(e=>this.createBlockFromParsed(e))):r.innerBlocks&&r.innerBlocks.length>0&&d(e,[]),{clientId:e,blockName:r.name,changesApplied:t.length,message:`Block ${r.name} content updated successfully`,originalBlock:o}}async applyTemplatePartChanges(e,t,n){const r=await G(t),o={clientId:e,name:t.name,attributes:{...t.attributes},innerBlocks:t.innerBlocks?[...t.innerBlocks]:[],isTemplatePart:!0,entityContent:r?r.content:null},{getBlocks:a}=(0,s.select)("core/block-editor"),i=a(e);if(0===i.length)throw new Error("Template part has no inner blocks to modify");const{updateBlockAttributes:c,replaceInnerBlocks:l}=(0,s.dispatch)("core/block-editor");let d=0;const u=[];for(const e of i){let t=(0,L.serialize)(e),r=!1;for(const e of n){const{find:n,replace:o}=e;if("string"!=typeof n||"string"!=typeof o)throw new Error("Change must have find and replace as strings");const a=this.normalizeHtml(t),i=this.normalizeHtml(n),s=this.normalizeHtml(o);a.includes(i)&&(t=a.replace(i,s),r=!0,d++)}if(r){const n=(0,L.parse)(t);if(n&&n.length>0){const t=n[0];if(t.attributes&&c(e.clientId,t.attributes),t.innerBlocks&&t.innerBlocks.length>0){const n=t.innerBlocks.map(e=>this.createBlockFromParsed(e));l(e.clientId,n)}u.push(t)}}else u.push(e)}let p=null;return d>0&&(p=await W(t,u),p.success||console.warn("Template part entity update failed:",p.message)),{clientId:e,blockName:t.name,changesApplied:d,message:"Template part content updated successfully",originalBlock:o,isTemplatePart:!0,entityUpdateResult:p}}async restoreBlocks(e){if(!e||!Array.isArray(e))return{success:!1,message:"No undo data available"};const{updateBlockAttributes:t,replaceInnerBlocks:n}=(0,s.dispatch)("core/block-editor"),{getBlock:r}=(0,s.select)("core/block-editor"),o=[],a=[];for(const i of e)try{const{clientId:e,attributes:s,innerBlocks:c,isTemplatePart:l,entityContent:d}=i;if(!e){a.push("Missing clientId in undo data");continue}if(l&&d){const t=r(e);if(t){const r="string"==typeof d?d:d.raw||d.rendered;if(r){const o=(0,L.parse)(r),i=await W(t,o);i.success||(console.warn("Failed to restore template part entity:",i.message),a.push(`Template part entity restore failed: ${i.message}`)),n(e,o.map(e=>this.createBlockFromParsed(e)))}else console.error("No content string to restore for template part")}else console.error("Could not find block with clientId:",e)}else t(e,s),c&&Array.isArray(c)&&n(e,c.map(e=>this.createBlockFromParsed(e)));const u=l?"Template part":"Block";o.push({clientId:e,message:`${u} restored successfully`})}catch(e){a.push(`Failed to restore block: ${e.message}`),console.error("Failed to restore block:",e)}return{success:0===a.length,message:0===a.length?"All blocks restored successfully":"Some blocks failed to restore",results:o,errors:a}}normalizeHtml(e){let t=e.replace(/\s+/g," ").replace(/>\s+</g,"><").replace(/\\\//g,"/").trim();return t=t.replace(/<!--\s*wp:([^\s]+)\s+(\{.*?\})\s*-->/gs,(e,t,n)=>{try{let e=0,r=0;for(let t=0;t<n.length;t++)if("{"===n[t]&&e++,"}"===n[t]&&e--,0===e){r=t+1;break}const o=n.substring(0,r),a=JSON.parse(o);"button"===t&&(delete a.text,delete a.url,delete a.linkTarget,delete a.rel,"a"===a.tagName&&delete a.tagName,"button"===a.type&&delete a.type);const i=Object.keys(a).sort().reduce((e,t)=>(e[t]=a[t],e),{});return`\x3c!-- wp:${t} ${JSON.stringify(i)} --\x3e`}catch(t){return e}}),t}async handleDeleteAction(e){const{getBlock:t}=(0,s.select)("core/block-editor"),n=t(e);if(!n)throw new Error(`Block with clientId ${e} not found`);if($(n))return this.handleDeleteTemplatePart(e,n);const r={clientId:e,name:n.name,attributes:{...n.attributes},innerBlocks:n.innerBlocks?[...n.innerBlocks]:[]},{removeBlock:o}=(0,s.dispatch)("core/block-editor");return o(e),{clientId:e,blockName:n.name,message:`Block ${n.name} deleted successfully`,originalBlock:r}}async handleDeleteTemplatePart(e,t){const n=await G(t),r={clientId:e,name:t.name,attributes:{...t.attributes},innerBlocks:t.innerBlocks?[...t.innerBlocks]:[],isTemplatePart:!0,entityContent:n?n.content:null},{removeBlock:o}=(0,s.dispatch)("core/block-editor");return o(e),{clientId:e,blockName:t.name,message:"Template part deleted successfully",originalBlock:r,isTemplatePart:!0}}getEffectiveRootBlocks(){const{getBlocks:e}=(0,s.select)("core/block-editor"),t=e(),n=t.find(e=>"core/post-content"===e.name);if(n){const t=e(n.clientId);if(t.length>0)return{blocks:t,parentClientId:n.clientId}}return{blocks:t,parentClientId:null}}findBlockContext(e){const{getBlocks:t}=(0,s.select)("core/block-editor"),n=t(),r=n.findIndex(t=>t.clientId===e);if(-1!==r)return{blocks:n,parentClientId:null,index:r};const o=n.find(e=>"core/post-content"===e.name);if(o){const n=t(o.clientId),r=n.findIndex(t=>t.clientId===e);if(-1!==r)return{blocks:n,parentClientId:o.clientId,index:r}}return null}async handleAddAction(e,t){const{getBlocks:n,getBlock:r}=(0,s.select)("core/block-editor"),{insertBlocks:o}=(0,s.dispatch)("core/block-editor"),a=[],i=[];for(const e of t)if(e.block_content&&"string"==typeof e.block_content)try{const t=(0,L.parse)(e.block_content);if(!t||0===t.length){a.push("Failed to parse block_content into blocks");continue}const n=t.map(e=>this.createBlockFromParsed(e));i.push(...n)}catch(e){a.push(`Failed to parse block_content: ${e.message}`),console.error("Failed to parse block_content:",e)}else a.push("Add action change missing block_content string");if(0===i.length)throw new Error("No valid blocks to insert");if(null===e){const e=this.getEffectiveRootBlocks();if(e.blocks.length>0)e.parentClientId?o(i,0,e.parentClientId):o(i,0,e.blocks[0].clientId);else{const e=n().find(e=>"core/post-content"===e.name);e?o(i,0,e.clientId):o(i,0)}}else{if(!r(e))throw new Error(`Target block with clientId ${e} not found`);const t=this.findBlockContext(e);if(!t)throw new Error(`Target block ${e} not found in root blocks or post-content`);const n=t.index+1;t.parentClientId?o(i,n,t.parentClientId):n<t.blocks.length?o(i,n,t.blocks[n].clientId):o(i,n)}const c=i.map(e=>e.clientId||null).filter(Boolean);return{clientId:e||"root",blocksAdded:i.length,insertedClientIds:c,message:`Added ${i.length} block(s) successfully`,errors:a.length>0?a:void 0}}createBlockFromParsed(e){const t=e.innerBlocks?e.innerBlocks.map(e=>this.createBlockFromParsed(e)):[];return(0,L.createBlock)(e.name,e.attributes||{},t)}},Y=q,V=async()=>({page:{page_id:(0,s.select)("core/editor").getCurrentPostId(),page_title:(0,s.select)("core/editor").getEditedPostAttribute("title")||"",selected_block:H(),content:await B()}}),X=async()=>{try{return await O()({path:"/nfd-editor-chat/v1/chat/new",method:"POST"})}catch(e){throw console.error("Error creating new conversation:",e),e}},K=()=>{const e=(e=>{if(!e||"string"!=typeof e)return"0";let t=5381;for(let n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n),t|=0;return(t>>>0).toString(16)})(window.location.origin);return{CONVERSATION_ID:`nfd-editor-chat-conversation-id-${e}`,MESSAGES:`nfd-editor-chat-messages-${e}`}},J=()=>{try{const e=K();return localStorage.getItem(e.CONVERSATION_ID)}catch(e){return console.warn("Failed to load conversation ID from localStorage:",e),null}},Z=()=>{const e=J(),t=(()=>{try{const e=K(),t=localStorage.getItem(e.MESSAGES);return t?JSON.parse(t).map(e=>{const{hasActions:t,undoData:n,...r}=e;return r}):[]}catch(e){return console.warn("Failed to load messages from localStorage:",e),[]}})(),[n,r]=(0,l.useState)(t||[]),[o,a]=(0,l.useState)(!1),[i,c]=(0,l.useState)(e),[u,p]=(0,l.useState)(null),[m,h]=(0,l.useState)(null),[f,g]=(0,l.useState)(!1),y=(0,l.useRef)(!1),_=(0,l.useRef)(null),w=(0,l.useRef)(null),b=(0,l.useRef)(null),{savePost:A}=(0,s.useDispatch)("core/editor"),k=(0,s.useSelect)(e=>e("core/editor").isSavingPost(),[]);(0,l.useEffect)(()=>{f&&!k&&(r(e=>e.map(e=>{if(e.hasActions){const{hasActions:t,undoData:n,...r}=e;return r}return e})),g(!1))},[f,k]),(0,l.useEffect)(()=>{y.current||(y.current=!0,J()||(async()=>{try{const e=await X();e.conversationId&&c(e.conversationId)}catch(e){console.error("Failed to initialize conversation:",e)}})())},[]),(0,l.useEffect)(()=>{(e=>{try{const t=K();e?localStorage.setItem(t.CONVERSATION_ID,e):localStorage.removeItem(t.CONVERSATION_ID)}catch(e){console.warn("Failed to save conversation ID to localStorage:",e)}})(i)},[i]),(0,l.useEffect)(()=>{n.length>0&&(e=>{try{const t=K();localStorage.setItem(t.MESSAGES,JSON.stringify(e))}catch(e){console.warn("Failed to save messages to localStorage:",e)}})(n)},[n]),(0,l.useEffect)(()=>()=>{_.current&&(clearInterval(_.current),_.current=null),w.current&&(clearTimeout(w.current),w.current=null)},[]);const E=()=>{_.current&&(clearInterval(_.current),_.current=null),w.current&&(clearTimeout(w.current),w.current=null),b.current=null};return{messages:n,isLoading:o,conversationId:i,error:u,status:m,isSaving:f,handleSendMessage:async e=>{if(p(null),h(null),!i)return void p((0,d.__)("No active conversation. Please refresh the page and try again.","wp-module-editor-chat"));const t={type:"user",content:e};r(e=>[...e,t]),a(!0),h("received");try{const t=await(async(e,t)=>{try{const n={message:t,context:await V(),conversationId:e};return await O()({path:"/nfd-editor-chat/v1/chat",method:"POST",data:n})}catch(e){throw console.error("Error sending message:",e),e}})(i,e);if(!t.message_id)throw console.error("No message_id in response:",t),new Error("No message_id received from API");const o=t.message_id;setTimeout(()=>{(e=>{E(),b.current=Date.now();const t=12e4,o=async()=>{try{if(Date.now()-b.current>=t)return E(),p((0,d.__)("The request is taking longer than expected. Please try again or refresh the page.","wp-module-editor-chat")),a(!1),void h(null);const o=await(async e=>{try{return await O()({path:"/nfd-editor-chat/v1/chat/status",method:"POST",data:{message_id:e}})}catch(e){throw console.error("Error checking status:",e),e}})(e),i=o.status;if(h(i),"completed"===i){if(E(),o.data){const e=o.data;let t="I received your message.";e.chat?.current_message?.assistant&&(t=e.chat.current_message.assistant);let a=!1,i=null;if(e.actions&&Array.isArray(e.actions)&&e.actions.length>0)try{if(n.some(e=>e.hasActions)){const t=n.find(e=>e.hasActions&&e.undoData);i=t?t.undoData:null,await Y.executeActions(e.actions),a=!0}else{const t=await Y.executeActions(e.actions);a=!0,t.results&&t.results.length>0&&(i=[],t.results.forEach(e=>{e.results&&Array.isArray(e.results)&&e.results.forEach(e=>{e.originalBlock&&i.push(e.originalBlock)})}))}}catch(e){console.error("Error executing actions:",e)}const s={type:"assistant",content:t,hasActions:a,undoData:i};r(e=>[...e,s])}a(!1),h(null)}else"failed"===i&&(E(),p((0,d.__)("Sorry, I encountered an error processing your request. Please try again.","wp-module-editor-chat")),a(!1),h(null))}catch(e){console.error("Error checking status:",e),Date.now()-b.current>=t&&(E(),p((0,d.__)("The request is taking longer than expected. Please try again or refresh the page.","wp-module-editor-chat")),a(!1),h(null))}};o(),_.current=setInterval(o,4e3),w.current=setTimeout(()=>{E(),p((0,d.__)("The request is taking longer than expected. Please try again or refresh the page.","wp-module-editor-chat")),a(!1),h(null)},t)})(o)},0)}catch(e){console.error("Error sending message:",e),p((0,d.__)("Sorry, I encountered an error processing your request. Please try again.","wp-module-editor-chat")),a(!1),h(null)}},handleNewChat:async()=>{E(),a(!1),h(null),r([]),c(null),p(null),(()=>{try{const e=K();localStorage.removeItem(e.CONVERSATION_ID),localStorage.removeItem(e.MESSAGES)}catch(e){console.warn("Failed to clear chat data from localStorage:",e)}})();try{const e=await X();e.conversationId&&c(e.conversationId)}catch(e){console.error("Failed to create new conversation:",e)}},handleAcceptChanges:()=>{g(!0),A&&A()},handleDeclineChanges:async()=>{const e=n.find(e=>e.hasActions&&e.undoData);if(e&&e.undoData)try{await Y.restoreBlocks(e.undoData),r(e=>e.map(e=>{if(e.hasActions){const{hasActions:t,undoData:n,...r}=e;return r}return e}))}catch(e){console.error("Error restoring blocks:",e)}else console.error("No undo data available")},handleStopRequest:()=>{E(),a(!1),h(null),p(null)}}},Q=window.wp.components,ee=window.React,te=(...e)=>e.filter((e,t,n)=>Boolean(e)&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim();var ne={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const re=(0,ee.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:o="",children:a,iconNode:i,...s},c)=>(0,ee.createElement)("svg",{ref:c,...ne,width:t,height:t,stroke:e,strokeWidth:r?24*Number(n)/Number(t):n,className:te("lucide",o),...s},[...i.map(([e,t])=>(0,ee.createElement)(e,t)),...Array.isArray(a)?a:[a]])),oe=(e,t)=>{const n=(0,ee.forwardRef)(({className:n,...r},o)=>{return(0,ee.createElement)(re,{ref:o,iconNode:t,className:te(`lucide-${a=e,a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,n),...r});var a});return n.displayName=`${e}`,n},ae=oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),ie=oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),se=window.ReactJSXRuntime,ce=({pendingCount:e,onAccept:t,onDecline:n,isSaving:r})=>{const o=1===e?"change":"changes";return(0,se.jsxs)("div",{className:"nfd-editor-chat-action-buttons",children:[(0,se.jsxs)("div",{className:"nfd-editor-chat-action-buttons__indicator",children:[(0,se.jsx)("span",{className:"nfd-editor-chat-action-buttons__indicator-dot"}),e," pending ",o]}),(0,se.jsxs)("div",{className:"nfd-editor-chat-action-buttons__buttons",children:[(0,se.jsxs)(Q.Button,{className:"nfd-editor-chat-action-buttons__button nfd-editor-chat-action-buttons__button--decline",onClick:n,disabled:r,children:[(0,se.jsx)(ae,{size:12}),"Revert All"]}),(0,se.jsxs)(Q.Button,{className:"nfd-editor-chat-action-buttons__button nfd-editor-chat-action-buttons__button--accept",onClick:t,disabled:r,children:[(0,se.jsx)(ie,{size:14}),"Keep Changes"]})]})]})},le=oe("CircleStop",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]]),de=oe("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),ue=oe("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]),pe=({block:e,onRemove:t})=>{if(!e)return null;const n=(r=e.name)?r.split("/").pop().split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"";var r;const o=e.attributes?.metadata?.name,a=e.name.split("/").pop(),i=["paragraph","heading"].includes(a),s=e.attributes?.content,c=i?(l=s)&&l.replace(/<[^>]*>/g,"").trim()||null:null;var l;let u=n;o?u=`${n}: ${o}`:c&&(u=`${n}: ${c}`);const p=u;return u.length>30&&(u=`${u.substring(0,30)}...`),(0,se.jsxs)("div",{className:"nfd-editor-chat-context-tag",title:p,children:[(0,se.jsx)("span",{className:"nfd-editor-chat-context-tag__label",children:(0,se.jsx)(ue,{size:12})}),t&&(0,se.jsx)("button",{className:"nfd-editor-chat-context-tag__remove",onClick:()=>t(e.clientId),"aria-label":(0,d.__)("Remove context","wp-module-editor-chat"),children:(0,se.jsx)(ae,{size:12})}),(0,se.jsx)("span",{className:"nfd-editor-chat-context-tag__block",children:u})]})},me=({onSendMessage:e,onStopRequest:t,disabled:n=!1})=>{const[r,o]=(0,l.useState)(""),a=(0,l.useRef)(null),i=(0,s.useSelect)(()=>H(),[]),{clearSelectedBlock:c}=(0,s.useDispatch)("core/block-editor");(0,l.useEffect)(()=>{if(a.current){a.current.style.height="auto";const e=Math.min(a.current.scrollHeight,200);a.current.style.height=`${e}px`}},[r]),(0,l.useEffect)(()=>{!n&&a.current&&setTimeout(()=>{a.current.focus()},100)},[n]);const u=()=>{r.trim()&&!n&&(e(r),o(""),a.current&&(a.current.style.height="auto",a.current.focus()))};return(0,se.jsxs)("div",{className:"nfd-editor-chat-input",children:[(0,se.jsxs)("div",{className:"nfd-editor-chat-input__container",children:[(0,se.jsx)("textarea",{name:"nfd-editor-chat-input",ref:a,value:r,onChange:e=>o(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),u())},placeholder:(0,d.__)("How can I help you today?","wp-module-editor-chat"),className:"nfd-editor-chat-input__textarea",rows:1,disabled:n}),(0,se.jsxs)("div",{className:"nfd-editor-chat-input__actions",children:[i&&(0,se.jsx)(pe,{block:i,onRemove:e=>{c(e)}}),n?(0,se.jsx)(Q.Button,{icon:(0,se.jsx)(le,{width:16,height:16}),label:(0,d.__)("Stop generating","wp-module-editor-chat"),onClick:t,className:"nfd-editor-chat-input__stop"}):(0,se.jsx)(Q.Button,{icon:(0,se.jsx)(de,{width:16,height:16}),label:(0,d.__)("Send message","wp-module-editor-chat"),onClick:u,className:"nfd-editor-chat-input__submit",disabled:!r.trim()})]})]}),(0,se.jsx)("div",{className:"nfd-editor-chat-input__disclaimer",children:(0,d.__)("AI-generated content is not guaranteed for accuracy.","wp-module-editor-chat")})]})},he=oe("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),fe=({message:e,className:t=""})=>(0,se.jsxs)("div",{className:`nfd-editor-chat-error-alert ${t}`,children:[(0,se.jsx)("div",{className:"nfd-editor-chat-error-alert__icon",children:(0,se.jsx)(he,{width:16,height:16})}),(0,se.jsx)("div",{className:"nfd-editor-chat-error-alert__content",children:(0,se.jsx)("div",{className:"nfd-editor-chat-error-alert__message",children:e})})]}),ge=({status:e=null})=>(0,se.jsx)("div",{className:"nfd-editor-chat-message nfd-editor-chat-message--assistant",children:(0,se.jsx)("div",{className:"nfd-editor-chat-message__content",children:(0,se.jsxs)("div",{className:"nfd-editor-chat-typing-indicator",children:[(0,se.jsx)("div",{className:"nfd-editor-chat-typing-indicator__loader"}),e&&(0,se.jsx)("div",{className:"nfd-editor-chat-typing-indicator__status",children:(()=>{switch(e){case"received":return(0,d.__)("Message received...","wp-module-editor-chat");case"generating":return(0,d.__)("Generating response...","wp-module-editor-chat");case"completed":return(0,d.__)("Processing...","wp-module-editor-chat");case"failed":return(0,d.__)("Error occurred","wp-module-editor-chat");default:return(0,d.__)("Thinking...","wp-module-editor-chat")}})()})]})})}),{entries:ye,setPrototypeOf:_e,isFrozen:we,getPrototypeOf:be,getOwnPropertyDescriptor:Ae}=Object;let{freeze:ke,seal:Ee,create:ve}=Object,{apply:Te,construct:Se}="undefined"!=typeof Reflect&&Reflect;ke||(ke=function(e){return e}),Ee||(Ee=function(e){return e}),Te||(Te=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return e.apply(t,r)}),Se||(Se=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new e(...n)});const Ne=He(Array.prototype.forEach),xe=He(Array.prototype.lastIndexOf),Ce=He(Array.prototype.pop),Ie=He(Array.prototype.push),Re=He(Array.prototype.splice),De=He(String.prototype.toLowerCase),Me=He(String.prototype.toString),Oe=He(String.prototype.match),Le=He(String.prototype.replace),Be=He(String.prototype.indexOf),Pe=He(String.prototype.trim),je=He(Object.prototype.hasOwnProperty),ze=He(RegExp.prototype.test),Fe=(Ue=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Se(Ue,t)});var Ue;function He(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return Te(e,t,r)}}function $e(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:De;_e&&_e(e,null);let r=t.length;for(;r--;){let o=t[r];if("string"==typeof o){const e=n(o);e!==o&&(we(t)||(t[r]=e),o=e)}e[o]=!0}return e}function Ge(e){for(let t=0;t<e.length;t++)je(e,t)||(e[t]=null);return e}function We(e){const t=ve(null);for(const[n,r]of ye(e))je(e,n)&&(Array.isArray(r)?t[n]=Ge(r):r&&"object"==typeof r&&r.constructor===Object?t[n]=We(r):t[n]=r);return t}function qe(e,t){for(;null!==e;){const n=Ae(e,t);if(n){if(n.get)return He(n.get);if("function"==typeof n.value)return He(n.value)}e=be(e)}return function(){return null}}const Ye=ke(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Ve=ke(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Xe=ke(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Ke=ke(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Je=ke(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ze=ke(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Qe=ke(["#text"]),et=ke(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),tt=ke(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),nt=ke(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),rt=ke(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ot=Ee(/\{\{[\w\W]*|[\w\W]*\}\}/gm),at=Ee(/<%[\w\W]*|[\w\W]*%>/gm),it=Ee(/\$\{[\w\W]*/gm),st=Ee(/^data-[\-\w.\u00B7-\uFFFF]+$/),ct=Ee(/^aria-[\-\w]+$/),lt=Ee(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),dt=Ee(/^(?:\w+script|data):/i),ut=Ee(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),pt=Ee(/^html$/i),mt=Ee(/^[a-z][.\w]*(-[.\w]+)+$/i);var ht=Object.freeze({__proto__:null,ARIA_ATTR:ct,ATTR_WHITESPACE:ut,CUSTOM_ELEMENT:mt,DATA_ATTR:st,DOCTYPE_NAME:pt,ERB_EXPR:at,IS_ALLOWED_URI:lt,IS_SCRIPT_OR_DATA:dt,MUSTACHE_EXPR:ot,TMPLIT_EXPR:it});const ft=function(){return"undefined"==typeof window?null:window};var gt=function e(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft();const n=t=>e(t);if(n.version="3.3.0",n.removed=[],!t||!t.document||9!==t.document.nodeType||!t.Element)return n.isSupported=!1,n;let{document:r}=t;const o=r,a=o.currentScript,{DocumentFragment:i,HTMLTemplateElement:s,Node:c,Element:l,NodeFilter:d,NamedNodeMap:u=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:p,DOMParser:m,trustedTypes:h}=t,f=l.prototype,g=qe(f,"cloneNode"),y=qe(f,"remove"),_=qe(f,"nextSibling"),w=qe(f,"childNodes"),b=qe(f,"parentNode");if("function"==typeof s){const e=r.createElement("template");e.content&&e.content.ownerDocument&&(r=e.content.ownerDocument)}let A,k="";const{implementation:E,createNodeIterator:v,createDocumentFragment:T,getElementsByTagName:S}=r,{importNode:N}=o;let x={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]};n.isSupported="function"==typeof ye&&"function"==typeof b&&E&&void 0!==E.createHTMLDocument;const{MUSTACHE_EXPR:C,ERB_EXPR:I,TMPLIT_EXPR:R,DATA_ATTR:D,ARIA_ATTR:M,IS_SCRIPT_OR_DATA:O,ATTR_WHITESPACE:L,CUSTOM_ELEMENT:B}=ht;let{IS_ALLOWED_URI:P}=ht,j=null;const z=$e({},[...Ye,...Ve,...Xe,...Je,...Qe]);let F=null;const U=$e({},[...et,...tt,...nt,...rt]);let H=Object.seal(ve(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),$=null,G=null;const W=Object.seal(ve(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let q=!0,Y=!0,V=!1,X=!0,K=!1,J=!0,Z=!1,Q=!1,ee=!1,te=!1,ne=!1,re=!1,oe=!0,ae=!1,ie=!0,se=!1,ce={},le=null;const de=$e({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ue=null;const pe=$e({},["audio","video","img","source","image","track"]);let me=null;const he=$e({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),fe="http://www.w3.org/1998/Math/MathML",ge="http://www.w3.org/2000/svg",_e="http://www.w3.org/1999/xhtml";let we=_e,be=!1,Ae=null;const Ee=$e({},[fe,ge,_e],Me);let Te=$e({},["mi","mo","mn","ms","mtext"]),Se=$e({},["annotation-xml"]);const Ue=$e({},["title","style","font","a","script"]);let He=null;const Ge=["application/xhtml+xml","text/html"];let ot=null,at=null;const it=r.createElement("form"),st=function(e){return e instanceof RegExp||e instanceof Function},ct=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!at||at!==e){if(e&&"object"==typeof e||(e={}),e=We(e),He=-1===Ge.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE,ot="application/xhtml+xml"===He?Me:De,j=je(e,"ALLOWED_TAGS")?$e({},e.ALLOWED_TAGS,ot):z,F=je(e,"ALLOWED_ATTR")?$e({},e.ALLOWED_ATTR,ot):U,Ae=je(e,"ALLOWED_NAMESPACES")?$e({},e.ALLOWED_NAMESPACES,Me):Ee,me=je(e,"ADD_URI_SAFE_ATTR")?$e(We(he),e.ADD_URI_SAFE_ATTR,ot):he,ue=je(e,"ADD_DATA_URI_TAGS")?$e(We(pe),e.ADD_DATA_URI_TAGS,ot):pe,le=je(e,"FORBID_CONTENTS")?$e({},e.FORBID_CONTENTS,ot):de,$=je(e,"FORBID_TAGS")?$e({},e.FORBID_TAGS,ot):We({}),G=je(e,"FORBID_ATTR")?$e({},e.FORBID_ATTR,ot):We({}),ce=!!je(e,"USE_PROFILES")&&e.USE_PROFILES,q=!1!==e.ALLOW_ARIA_ATTR,Y=!1!==e.ALLOW_DATA_ATTR,V=e.ALLOW_UNKNOWN_PROTOCOLS||!1,X=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,K=e.SAFE_FOR_TEMPLATES||!1,J=!1!==e.SAFE_FOR_XML,Z=e.WHOLE_DOCUMENT||!1,te=e.RETURN_DOM||!1,ne=e.RETURN_DOM_FRAGMENT||!1,re=e.RETURN_TRUSTED_TYPE||!1,ee=e.FORCE_BODY||!1,oe=!1!==e.SANITIZE_DOM,ae=e.SANITIZE_NAMED_PROPS||!1,ie=!1!==e.KEEP_CONTENT,se=e.IN_PLACE||!1,P=e.ALLOWED_URI_REGEXP||lt,we=e.NAMESPACE||_e,Te=e.MATHML_TEXT_INTEGRATION_POINTS||Te,Se=e.HTML_INTEGRATION_POINTS||Se,H=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&st(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(H.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&st(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(H.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(H.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),K&&(Y=!1),ne&&(te=!0),ce&&(j=$e({},Qe),F=[],!0===ce.html&&($e(j,Ye),$e(F,et)),!0===ce.svg&&($e(j,Ve),$e(F,tt),$e(F,rt)),!0===ce.svgFilters&&($e(j,Xe),$e(F,tt),$e(F,rt)),!0===ce.mathMl&&($e(j,Je),$e(F,nt),$e(F,rt))),e.ADD_TAGS&&("function"==typeof e.ADD_TAGS?W.tagCheck=e.ADD_TAGS:(j===z&&(j=We(j)),$e(j,e.ADD_TAGS,ot))),e.ADD_ATTR&&("function"==typeof e.ADD_ATTR?W.attributeCheck=e.ADD_ATTR:(F===U&&(F=We(F)),$e(F,e.ADD_ATTR,ot))),e.ADD_URI_SAFE_ATTR&&$e(me,e.ADD_URI_SAFE_ATTR,ot),e.FORBID_CONTENTS&&(le===de&&(le=We(le)),$e(le,e.FORBID_CONTENTS,ot)),ie&&(j["#text"]=!0),Z&&$e(j,["html","head","body"]),j.table&&($e(j,["tbody"]),delete $.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw Fe('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw Fe('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');A=e.TRUSTED_TYPES_POLICY,k=A.createHTML("")}else void 0===A&&(A=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(n=t.getAttribute(r));const o="dompurify"+(n?"#"+n:"");try{return e.createPolicy(o,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+o+" could not be created."),null}}(h,a)),null!==A&&"string"==typeof k&&(k=A.createHTML(""));ke&&ke(e),at=e}},dt=$e({},[...Ve,...Xe,...Ke]),ut=$e({},[...Je,...Ze]),mt=function(e){Ie(n.removed,{element:e});try{b(e).removeChild(e)}catch(t){y(e)}},gt=function(e,t){try{Ie(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){Ie(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(te||ne)try{mt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},yt=function(e){let t=null,n=null;if(ee)e="<remove></remove>"+e;else{const t=Oe(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===He&&we===_e&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const o=A?A.createHTML(e):e;if(we===_e)try{t=(new m).parseFromString(o,He)}catch(e){}if(!t||!t.documentElement){t=E.createDocument(we,"template",null);try{t.documentElement.innerHTML=be?k:o}catch(e){}}const a=t.body||t.documentElement;return e&&n&&a.insertBefore(r.createTextNode(n),a.childNodes[0]||null),we===_e?S.call(t,Z?"html":"body")[0]:Z?t.documentElement:a},_t=function(e){return v.call(e.ownerDocument||e,e,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},wt=function(e){return e instanceof p&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof u)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},bt=function(e){return"function"==typeof c&&e instanceof c};function At(e,t,r){Ne(e,e=>{e.call(n,t,r,at)})}const kt=function(e){let t=null;if(At(x.beforeSanitizeElements,e,null),wt(e))return mt(e),!0;const r=ot(e.nodeName);if(At(x.uponSanitizeElement,e,{tagName:r,allowedTags:j}),J&&e.hasChildNodes()&&!bt(e.firstElementChild)&&ze(/<[/\w!]/g,e.innerHTML)&&ze(/<[/\w!]/g,e.textContent))return mt(e),!0;if(7===e.nodeType)return mt(e),!0;if(J&&8===e.nodeType&&ze(/<[/\w]/g,e.data))return mt(e),!0;if(!(W.tagCheck instanceof Function&&W.tagCheck(r))&&(!j[r]||$[r])){if(!$[r]&&vt(r)){if(H.tagNameCheck instanceof RegExp&&ze(H.tagNameCheck,r))return!1;if(H.tagNameCheck instanceof Function&&H.tagNameCheck(r))return!1}if(ie&&!le[r]){const t=b(e)||e.parentNode,n=w(e)||e.childNodes;if(n&&t)for(let r=n.length-1;r>=0;--r){const o=g(n[r],!0);o.__removalCount=(e.__removalCount||0)+1,t.insertBefore(o,_(e))}}return mt(e),!0}return e instanceof l&&!function(e){let t=b(e);t&&t.tagName||(t={namespaceURI:we,tagName:"template"});const n=De(e.tagName),r=De(t.tagName);return!!Ae[e.namespaceURI]&&(e.namespaceURI===ge?t.namespaceURI===_e?"svg"===n:t.namespaceURI===fe?"svg"===n&&("annotation-xml"===r||Te[r]):Boolean(dt[n]):e.namespaceURI===fe?t.namespaceURI===_e?"math"===n:t.namespaceURI===ge?"math"===n&&Se[r]:Boolean(ut[n]):e.namespaceURI===_e?!(t.namespaceURI===ge&&!Se[r])&&!(t.namespaceURI===fe&&!Te[r])&&!ut[n]&&(Ue[n]||!dt[n]):!("application/xhtml+xml"!==He||!Ae[e.namespaceURI]))}(e)?(mt(e),!0):"noscript"!==r&&"noembed"!==r&&"noframes"!==r||!ze(/<\/no(script|embed|frames)/i,e.innerHTML)?(K&&3===e.nodeType&&(t=e.textContent,Ne([C,I,R],e=>{t=Le(t,e," ")}),e.textContent!==t&&(Ie(n.removed,{element:e.cloneNode()}),e.textContent=t)),At(x.afterSanitizeElements,e,null),!1):(mt(e),!0)},Et=function(e,t,n){if(oe&&("id"===t||"name"===t)&&(n in r||n in it))return!1;if(Y&&!G[t]&&ze(D,t));else if(q&&ze(M,t));else if(W.attributeCheck instanceof Function&&W.attributeCheck(t,e));else if(!F[t]||G[t]){if(!(vt(e)&&(H.tagNameCheck instanceof RegExp&&ze(H.tagNameCheck,e)||H.tagNameCheck instanceof Function&&H.tagNameCheck(e))&&(H.attributeNameCheck instanceof RegExp&&ze(H.attributeNameCheck,t)||H.attributeNameCheck instanceof Function&&H.attributeNameCheck(t,e))||"is"===t&&H.allowCustomizedBuiltInElements&&(H.tagNameCheck instanceof RegExp&&ze(H.tagNameCheck,n)||H.tagNameCheck instanceof Function&&H.tagNameCheck(n))))return!1}else if(me[t]);else if(ze(P,Le(n,L,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Be(n,"data:")||!ue[e])if(V&&!ze(O,Le(n,L,"")));else if(n)return!1;return!0},vt=function(e){return"annotation-xml"!==e&&Oe(e,B)},Tt=function(e){At(x.beforeSanitizeAttributes,e,null);const{attributes:t}=e;if(!t||wt(e))return;const r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:F,forceKeepAttr:void 0};let o=t.length;for(;o--;){const a=t[o],{name:i,namespaceURI:s,value:c}=a,l=ot(i),d=c;let u="value"===i?d:Pe(d);if(r.attrName=l,r.attrValue=u,r.keepAttr=!0,r.forceKeepAttr=void 0,At(x.uponSanitizeAttribute,e,r),u=r.attrValue,!ae||"id"!==l&&"name"!==l||(gt(i,e),u="user-content-"+u),J&&ze(/((--!?|])>)|<\/(style|title|textarea)/i,u)){gt(i,e);continue}if("attributename"===l&&Oe(u,"href")){gt(i,e);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr){gt(i,e);continue}if(!X&&ze(/\/>/i,u)){gt(i,e);continue}K&&Ne([C,I,R],e=>{u=Le(u,e," ")});const p=ot(e.nodeName);if(Et(p,l,u)){if(A&&"object"==typeof h&&"function"==typeof h.getAttributeType)if(s);else switch(h.getAttributeType(p,l)){case"TrustedHTML":u=A.createHTML(u);break;case"TrustedScriptURL":u=A.createScriptURL(u)}if(u!==d)try{s?e.setAttributeNS(s,i,u):e.setAttribute(i,u),wt(e)?mt(e):Ce(n.removed)}catch(t){gt(i,e)}}else gt(i,e)}At(x.afterSanitizeAttributes,e,null)},St=function e(t){let n=null;const r=_t(t);for(At(x.beforeSanitizeShadowDOM,t,null);n=r.nextNode();)At(x.uponSanitizeShadowNode,n,null),kt(n),Tt(n),n.content instanceof i&&e(n.content);At(x.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,a=null,s=null,l=null;if(be=!e,be&&(e="\x3c!--\x3e"),"string"!=typeof e&&!bt(e)){if("function"!=typeof e.toString)throw Fe("toString is not a function");if("string"!=typeof(e=e.toString()))throw Fe("dirty is not a string, aborting")}if(!n.isSupported)return e;if(Q||ct(t),n.removed=[],"string"==typeof e&&(se=!1),se){if(e.nodeName){const t=ot(e.nodeName);if(!j[t]||$[t])throw Fe("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof c)r=yt("\x3c!----\x3e"),a=r.ownerDocument.importNode(e,!0),1===a.nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?r=a:r.appendChild(a);else{if(!te&&!K&&!Z&&-1===e.indexOf("<"))return A&&re?A.createHTML(e):e;if(r=yt(e),!r)return te?null:re?k:""}r&&ee&&mt(r.firstChild);const d=_t(se?e:r);for(;s=d.nextNode();)kt(s),Tt(s),s.content instanceof i&&St(s.content);if(se)return e;if(te){if(ne)for(l=T.call(r.ownerDocument);r.firstChild;)l.appendChild(r.firstChild);else l=r;return(F.shadowroot||F.shadowrootmode)&&(l=N.call(o,l,!0)),l}let u=Z?r.outerHTML:r.innerHTML;return Z&&j["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&ze(pt,r.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+u),K&&Ne([C,I,R],e=>{u=Le(u,e," ")}),A&&re?A.createHTML(u):u},n.setConfig=function(){ct(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Q=!0},n.clearConfig=function(){at=null,Q=!1},n.isValidAttribute=function(e,t,n){at||ct({});const r=ot(e),o=ot(t);return Et(r,o,n)},n.addHook=function(e,t){"function"==typeof t&&Ie(x[e],t)},n.removeHook=function(e,t){if(void 0!==t){const n=xe(x[e],t);return-1===n?void 0:Re(x[e],n,1)[0]}return Ce(x[e])},n.removeHooks=function(e){x[e]=[]},n.removeAllHooks=function(){x={afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}},n}();const yt=e=>/<[a-z][\s\S]*>/i.test(e),_t=({message:e,type:t="assistant"})=>{const n="user"===t,r=(0,l.useMemo)(()=>e?n?e:yt(e)?(e=>gt.sanitize(e,{ALLOWED_TAGS:["section","div","h1","h2","h3","h4","h5","h6","p","span","strong","em","b","i","u","s","mark","small","sub","sup","a","br","ul","ol","li","dl","dt","dd","blockquote","code","pre","table","thead","tbody","tr","th","td","hr","address","time"],ALLOWED_ATTR:["style","class","id","href","datetime"],ALLOW_DATA_ATTR:!1,FORBID_TAGS:["script","object","embed","iframe","form","fieldset","legend","label","input","textarea","select","option","button","details","summary","progress","meter"],FORBID_ATTR:["onerror","onload","onclick","onmouseover","onfocus","onblur"]}))(e):e:"",[e,n]),o=!n&&yt(e);return(0,se.jsx)("div",{className:`nfd-editor-chat-message nfd-editor-chat-message--${t}`,children:o?(0,se.jsx)("div",{className:"nfd-editor-chat-message__content",dangerouslySetInnerHTML:{__html:r}}):(0,se.jsx)("div",{className:"nfd-editor-chat-message__content",children:r})})},wt=({messages:e=[],isLoading:t=!1,error:n=null,status:r=null})=>{const o=(0,l.useRef)(null);return(0,l.useEffect)(()=>{o.current?.scrollIntoView({behavior:"smooth"})},[e,t]),(0,se.jsxs)("div",{className:"nfd-editor-chat-messages",children:[e.length&&e.map((e,t)=>(0,se.jsx)(_t,{message:e.content,type:e.type},t)),n&&(0,se.jsx)(fe,{message:n}),t&&(0,se.jsx)(ge,{status:r}),(0,se.jsx)("div",{ref:o})]})};var bt;function At(){return At=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},At.apply(null,arguments)}oe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),oe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),oe("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]),oe("Layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);var kt=function(e){return ee.createElement("svg",At({xmlns:"http://www.w3.org/2000/svg",width:24,height:24,baseProfile:"basic",viewBox:"0 0 30 30"},e),bt||(bt=ee.createElement("path",{d:"m14.217 19.707-1.112 2.547a1.199 1.199 0 0 1-2.21 0l-1.112-2.547A9.8 9.8 0 0 0 4.79 14.65l-3.06-1.358c-.973-.432-.973-1.848 0-2.28l2.965-1.316C6.974 8.684 8.787 6.813 9.76 4.47l1.126-2.714a1.2 1.2 0 0 1 2.228 0L14.24 4.47c.973 2.344 2.786 4.215 5.065 5.226l2.965 1.316c.973.432.973 1.848 0 2.28l-3.061 1.359a9.8 9.8 0 0 0-4.992 5.056M24.481 27.796l-.339.777a.696.696 0 0 1-1.284 0l-.339-.777a6 6 0 0 0-3.051-3.092l-1.044-.464c-.565-.251-.565-1.072 0-1.323l.986-.438a6 6 0 0 0 3.095-3.195l.348-.84a.696.696 0 0 1 1.294 0l.348.84a6 6 0 0 0 3.095 3.195l.986.438c.565.251.565 1.072 0 1.323l-1.044.464a6 6 0 0 0-3.051 3.092"})))};const Et=({width:e=24,height:t=24})=>(0,se.jsx)("div",{className:"nfd-editor-chat-ai-avatar",style:{width:e,height:t},children:(0,se.jsx)(kt,{width:.625*e,height:.625*t})}),vt=({onSendMessage:e})=>((0,d.__)("Add a new section","wp-module-editor-chat"),(0,d.__)("Update color scheme","wp-module-editor-chat"),(0,d.__)("Create new page","wp-module-editor-chat"),(0,d.__)("Edit content","wp-module-editor-chat"),(0,se.jsxs)("div",{className:"nfd-editor-chat-welcome",children:[(0,se.jsxs)("div",{className:"nfd-editor-chat-welcome__content",children:[(0,se.jsx)("div",{className:"nfd-editor-chat-welcome__avatar",children:(0,se.jsx)(Et,{width:48,height:48})}),(0,se.jsxs)("div",{className:"nfd-editor-chat-welcome__message",children:[(0,se.jsx)("div",{className:"nfd-editor-chat-welcome__title",children:(0,d.__)("Hi, I'm BLU, your AI assistant.","wp-module-editor-chat")}),(0,se.jsx)("div",{className:"nfd-editor-chat-welcome__subtitle",children:(0,d.__)("I can help you update page sections and styles,","wp-module-editor-chat")}),(0,se.jsx)("div",{className:"nfd-editor-chat-welcome__subtitle",children:(0,d.__)("add, remove, or edit existing content.","wp-module-editor-chat")})]})]}),(0,se.jsx)("div",{className:"nfd-editor-chat-suggestions",children:!1})]})),Tt=oe("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),St=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Nt=({onNewChat:e,isNewChatDisabled:t=!1})=>(0,se.jsxs)("div",{className:"nfd-editor-chat-sidebar__header-content",children:[(0,se.jsxs)("div",{className:"interface-complementary-area-header__title",children:[(0,se.jsx)(Tt,{width:15,height:15}),(0,se.jsxs)("h2",{children:[(0,d.__)("Blu Chat","wp-module-editor-chat"),(0,se.jsx)("span",{className:"nfd-editor-chat-sidebar__beta-badge",children:"Beta"})]})]}),e&&(0,se.jsx)("div",{className:"nfd-editor-chat-sidebar__header-actions",children:(0,se.jsx)(Q.Button,{icon:(0,se.jsx)(St,{width:16,height:16}),label:(0,d.__)("New chat","wp-module-editor-chat"),onClick:e,className:"nfd-editor-chat-sidebar__new-chat",disabled:t})})]}),xt="nfd-editor-chat",Ct="core",It=()=>{const{enableComplementaryArea:e}=(0,s.useDispatch)(D),{messages:t,isLoading:n,error:r,status:o,isSaving:a,handleSendMessage:i,handleNewChat:u,handleAcceptChanges:p,handleDeclineChanges:m,handleStopRequest:h}=Z();(0,l.useEffect)(()=>{e(Ct,xt)},[e]);const f=t.filter(e=>e.hasActions).length,g=f>0,y=0===t.length;return(0,se.jsxs)(se.Fragment,{children:[(0,se.jsx)(c.PluginSidebarMoreMenuItem,{scope:Ct,target:xt,icon:(0,se.jsx)(Et,{width:24,height:24}),children:(0,d.__)("AI Chat Editor","wp-module-editor-chat")}),(0,se.jsx)(c.PluginSidebar,{scope:Ct,identifier:xt,className:"nfd-editor-chat-sidebar",closeLabel:(0,d.__)("Close AI Chat Editor","wp-module-editor-chat"),icon:(0,se.jsx)(Et,{width:24,height:24}),headerClassName:"nfd-editor-chat-sidebar__header",panelClassName:"nfd-editor-chat-sidebar__panel",header:(0,se.jsx)(Nt,{onNewChat:u,isNewChatDisabled:y}),children:(0,se.jsxs)("div",{className:"nfd-editor-chat-sidebar__content",children:[0===t.length?(0,se.jsx)(vt,{onSendMessage:i}):(0,se.jsx)(wt,{messages:t,isLoading:n,error:r,status:o}),g&&(0,se.jsx)(ce,{pendingCount:f,onAccept:p,onDecline:m,isSaving:a}),(0,se.jsx)(me,{onSendMessage:i,onStopRequest:h,disabled:n})]})})]})};a()(()=>{(0,i.registerPlugin)("nfd-editor-chat",{render:It})}),((((window.newfold=window.newfold||{}).wordpress=window.newfold.wordpress||{}).editor=window.newfold.wordpress.editor||{}).chat=window.newfold.wordpress.editor.chat||{})["chat-editor"]=t})();